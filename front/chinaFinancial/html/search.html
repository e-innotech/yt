<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>搜索</title>
    <link rel="stylesheet" href="../css/style.css"/>
    <link rel="stylesheet" href="../css/nav.css"/>
    <link rel="stylesheet" href="../css/search.css"/>
    <script type="text/javascript" src="../../script/jquery.min.js"></script>
    <script type="text/javascript" src="../../script/common.js"></script>
</head>
<body>
<div id="top"></div>
<div class="contentbg">
    <div class="content">
        <div class="content-left">
            <!--以下为搜索的数据的渲染-->
            <div id="searchlist">

            </div>
            <div class="more">加载更多</div>
        </div>
    </div>
</div>
<div class="bottom"></div>

</body>
</html>

<script>
    // 一进页面加载头
    window.onload=function(){
        $("#top").load("top.html");
        $("#bottom").load("bottom.html");
        init();
    }
    //搜索渲染
    var page = 1;
    var totalnum,list;
    var newsTitle = window.sessionStorage.getItem("global_newsTitle");
    function init(){
        var getSearchList = function (data) {
            console.log(121,data);
            totalnum=data.total;
            list=data.list;
            if(list.length<4){
                $('.more').html('没有更多了');
            }
        };

        //参数 网站id 新闻标题 当前页 显示页
        globalQuery(1,newsTitle,page,4, getSearchList);
        //拿到的搜索的数据
        for (var i=0;i <list.length; i++) {
            $('#searchlist').append('<ul class="news_list">' +
            '<li>'+
            '<a href="#">'+list[i].newsTitle+'</a>'+
            '<span>'+list[i].createDate+'</span>'+
            '</li>'+
            '<li>'+
            '<a href="#">'+list[i].source+'</a>'+
            '<span>'+list[i].createDate+'</span>'+
            '</li>'+
            '<li>'+
            '<a href="#">'+list[i].submitUserId+'</a>' +
            '<span>'+list[i].createDate+'</span>'+
            '</li>'+
            '<li>'+
            '<a href="#">'+list[i].subContent
            +'</a>' +
            '<span>'+list[i].createDate+'</span>'+
            '</li>'+
            '</ul>')
        }
    }
    $('.more').click(function () {
        if(page>=Math.ceil(totalnum/4)){
            $('.more').html('没有更多了');
        }
        else{
            page++;
            init();
        }
    });
</script>