<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>头部</title>
    <link rel="stylesheet" href="../css/style.css"/>
    <link rel="stylesheet" href="../css/top.css">
    <script src="../script/jquery.min.js"></script>
</head>
<body>
<!-- 以下为头部 -->
<div class="headerbg">
    <div class="header">
        <img src="../images/logo.png"/>
        <ul class="nav">

        </ul>
        <!--<a href="#" onclick="memberslogout();">退出登录</a>-->
        <div class="header-right">
            <div class="header-right-l">
                <form>
                    <input type="text" placeholder="搜索"/>
                    <a href="#"><img src="../images/search.png" id="search"/></a>
                </form>
            </div>
            <div class="header-right-r" id="loginbefore">
                <a href="template.html"><img src="../images/ren.png" class="userAvatar"/></a>
            </div>
            <div class="header-right-r" id="loginafter">
                <a href="template.html"><img src="../images/ren.png" class="userAvatar"/></a>
                <p onclick="logout()" id="logout" style="padding-top:5px;">退出登录</p>
            </div>

        </div>
    </div>
</div>
<div class="blank"></div>


</body>
</html>

<script>
    var channeldata;
    //点击退出登录按钮时
function logout(){
    sessionStorage.clear("synUser");
    if(sessionStorage.getItem("synUser") !== null){
        $("#loginafter").show();
        console.log("ok")
    }else{
        $("#loginbefore").show();
        $("#loginafter").hide();
        console.log("no")

    }
    console.log(123);
}
//    //导航栏的数据
//判断是不是首次进入，如果是发送ajax请求，请求数据且渲染页面，并存在session中 否则不是首次就调用缓存里的数据
    if(sessionStorage.getItem("channel") != null){
      console.log(22222);
        var channels= JSON.parse(sessionStorage.getItem("channel"));
        for(var i=0;i<channels.length;i++){
            $(".header .nav").append('<li><a>'+channels[i].channelName +
            ' </a></li>');
        }
    }else{
        console.log(1111111111)
        $.ajax({
            url:"http://123.59.156.27:8080/common/channel/3",
            dataType:"json",
            async:true,
            type:"get",
            success:function(channelData){
                  channeldata=channelData.data;
                  console.log(1111,channeldata);
                for(var i=0;i<channeldata.length;i++){
                    $(".header .nav").append('<li><a>'+channeldata[i].channelName +
                    ' </a></li>');
                }
                sessionStorage.setItem("channel",JSON.stringify(channeldata));
            }
        })
    }



$(document).ready(function(){
    if(sessionStorage.getItem("synUser") !== null){
        $("#loginafter").show();
        console.log("ok")
    }else{
        $("#loginbefore").show();
        console.log("no")

    }
})
window.onload=function() {

    $(".nav").on("click", "li", function () {
        $(this).addClass("active").siblings().removeClass("active")
    })
}










</script>