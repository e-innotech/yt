<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>搜索</title>
    <link rel="stylesheet" href="../css/style.css"/>
    <link rel="stylesheet" href="../css/nav.css"/>
    <link rel="stylesheet" href="../css/search.css"/>
    <script type="text/javascript" src="../../script/jquery.min.js"></script>
    <script type="text/javascript" src="../../script/common.js"></script>
    <script src="../script/js/top.js"></script>
</head>
<body>
<div id="top"></div>
<div class="contentbg">
    <div class="content">
        <div class="content-left">
            <!--以下为搜索页面的数据-->
            <div id="searchlist">
                <div class="news_list">
                    <a href="detail.html">
                        <h2>
                            独家 | 输给了空间阿里斯顿拉科技师范大咖啡里斯顿拉科技师范大里斯顿拉科技师范大
                        </h2>
                        <div>
                            咖啡色卡萨丁卡仕达克里斯多夫客户卡好久水电费卡拉胶发多少奥卡福咖啡壶丁卡仕达克色卡萨丁卡仕达克里斯多夫客户卡好久水电费卡拉胶发多少奥卡福咖啡壶丁卡仕达克色卡萨丁卡仕达克里斯多夫客户卡好久水电费卡拉胶发多少奥卡福咖啡壶丁卡仕达克里斯多夫客户卡好久水电费卡拉丁卡仕达克里斯多夫客户卡好久水电费卡拉
                        </div>
                        <p><span class="source">中南海</span><span class="date">2017-03-17</span></p>
                    </a>
                </div>
            </div>
            <input type="hidden" value="" id="search_key">
            <div class="more">加载更多</div>
        </div>
    </div>
</div>
<div class="bottom" id="bottom"></div>

</body>
</html>
<script>
    // 一进页面加载头
    window.onload=function(){
        var search = window.sessionStorage.getItem("global_search_data_searchKey");
        window.sessionStorage.removeItem("global_search_data_searchKey");
        $('#top').load('top.html');
        $('#bottom').load('bottom.html');
        $('#search_key').val(search);
    }

    //搜索渲染
    var page = 1;
    var list;
    function init(){
        var object = window.sessionStorage.getItem("global_search_data");
        var data = JSON.parse(object);
        var list = data.list;
//        searchData=list;
        for (var i = 0; i <list.length; i++) {
            $('#searchlist').append('<div class="news_list">' +
            '<a href="">' +
            '<h2>' +searchData[i].newsTitle+' </h2>' +
            '<div>' +searchData[i].subContent+'</div>' +
            '<p>' +
            '<span class="source">' +searchData[i].source+'</span>' +
            '<span class="date">' +searchData[i].createDate+'</span>' +
            '</p>' +
            '</div>' +
            '</a>' +
            '</div>');
        }
    }

    function nextSearchPage(){
        var newsKey = $('#search_key').val();
        globalQuery(websiteId, newsKey, page, 10, function callback(data){
//            searchData=data.list;
            var list = data.list;
            for (var i = 0; i < list.length; i++) {
                $('#searchlist').append('<div class="news_list">' +
                '<a href="">' +
                '<h2>' +searchData[i].newsTitle+' </h2>' +
                '<div>' +searchData[i].subContent+'</div>' +
                '<p>' +
                '<span class="source">' +searchData[i].source+'</span>' +
                '<span class="date">' +searchData[i].createDate+'</span>' +
                '</p>' +
                '</div>' +
                '</a>' +
                '</div>');

            }

        })
    };

    $('.more').click(function () {
//        console.log(343,searchData.length);
        console.log(5,typeof(searchData))
        if(list.length<= 0){
            $('.more').html('没有更多了');
        }else{
            page++;
            nextSearchPage();
        }
    });


//    // 一进页面加载头
//    window.onload=function(){
//        $("#top").load("top.html");
//        $("#bottom").load("bottom.html");
//        var search = window.sessionStorage.getItem("global_search_data_searchKey");
//        init();
//    }
//
//
//    //搜索渲染
//    var page = 1;
//    var searchData;
//    function init(){
//
//
//
//
//    }
//
//    var object = window.sessionStorage.getItem("global_search_data");
//    var data = JSON.parse(object);
//    var list = data.list;
//
//
//    $('.more').click(function () {
//        if(searchData.length<=0){
//            $('.more').html('没有更多了');
//        }else{
//            page++;
//            init()
//
//        }
//    });
//    function init(){
//        searchData=list;
//        //拿到的搜索的数据
//        for (var i = 0; i <searchData.length; i++) {
//            $('#searchlist').append('<div class="news_list">' +
//            '<a href="">' +
//            '<h2>' +searchData[i].newsTitle+' </h2>' +
//            '<div>' +searchData[i].subContent+'</div>' +
//            '<p>' +
//            '<span class="source">' +searchData[i].source+'</span>' +
//            '<span class="date">' +searchData[i].createDate+'</span>' +
//            '</p>' +
//            '</div>' +
//            '</a>' +
//            '</div>');
//
//     }
//        sessionStorage.removeItem("global_search_data");
//
//    }

</script>