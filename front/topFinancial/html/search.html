<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>搜索</title>
    <link rel="stylesheet" href="../css/style.css"/>
    <link rel="stylesheet" href="../css/nav.css"/>
    <link rel="stylesheet" href="../css/search.css"/>
    <script type="text/javascript" src="../../script/jquery.min.js"></script>
    <script type="text/javascript" src="../../script/common.js"></script>
    <script src="../script/js/top.js"></script>
</head>
<body>
<div id="top"></div>
<div class="contentbg">
    <div class="content">
        <div class="content-left">
            <!--以下为搜索页面的渲染-->
            <div id="searchlist">
                <div class="news_list">
                    <a href="detail.html">
                        <h2>
                            独家 | 输给了空间阿里斯顿拉科技师范大咖啡里斯顿拉科技师范大里斯顿拉科技师范大
                        </h2>
                        <p>2017-03-17</p>
                        <div>
                            咖啡色卡萨丁卡仕达克里斯多夫客户卡好久水电费卡拉胶发多少奥卡福咖啡壶丁卡仕达克色卡萨丁卡仕达克里斯多夫客户卡好久水电费卡拉胶发多少奥卡福咖啡壶丁卡仕达克色卡萨丁卡仕达克里斯多夫客户卡好久水电费卡拉胶发多少奥卡福咖啡壶丁卡仕达克里斯多夫客户卡好久水电费卡拉丁卡仕达克里斯多夫客户卡好久水电费卡拉
                        </div>
                    </a>
                </div>
            </div>
            <div class="more">点击加载更多</div>
        </div>
    </div>
</div>
<div class="bottom"></div>

</body>
</html>

<script>

// 一进页面加载头
window.onload=function(){
    $("#top").load("top.html");
    $("#bottom").load("bottom.html");
    init();
}
//搜索渲染
var page = 1;
var totalnum,list;
var newsTitle = window.sessionStorage.getItem("global_newsTitle");
function init(){
    var getSearchList = function (data) {
        console.log(121,data);
        totalnum=data.total;
        list=data.list;
        if(list.length<10){
            $('.more').html('没有更多了');
        }
    };

    //参数 网站id 新闻标题 当前页 显示页
    globalQuery(1,newsTitle,page, 10, getSearchList);
    //拿到的搜索的数据
    for (var i=0;i <list.length; i++) {
        $('#searchlist').append('<div class="news_list">' +
            '<a href="">' +
            '<h2>' +list[i].newsTitle+' </h2>' +
            '<p>' +list[i].createDate+'</p>'+
            '<div>' +list[i].subContent+'</div>' +
            '</a>' +
            '</div>');
    }
}
$('.more').click(function () {
    if(page>=Math.ceil(totalnum/10)){
        $('.more').html('没有更多了');
    }
    else{
        page++;
        init();
    }
});
</script>