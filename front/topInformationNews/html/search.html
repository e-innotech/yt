<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>搜索</title>
    <link rel="stylesheet" href="../css/nav.css"/>
    <script type="text/javascript" src="../../script/jquery.min.js"></script>
    <script type="text/javascript" src="../../script/common.js"></script>
    <style>
        .news_list .news_list_left{width:100%;margin-top:20px;}
        .news_list .news_list_left li{width:100%;height:145px;display:inline-block;background:#fff;padding:10px 0 0 10px;margin-bottom:30px;}
        .more_box{width:100%;text-align:center;}
    </style>
</head>
<body>
<div id="top"></div>
<div class="contentbg">
    <div class="content">
        <div class="content-left">
            <div class="news_list clearfix">
                <ul class="news_list_left fl">
                    <div id="navList"></div>
                </ul>
                <div style="clear: both"></div>
                <div class="more_box">
                    <div class="more">加载更多</div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="bottom" id="bottom"></div>
</body>
</html>

<script>
    // 一进页面加载头
    window.onload = function () {
        $("#top").load("top.html");
        $("#bottom").load("bottom.html");
        init();
    }
    //搜索渲染
    var page = 1;
    var totalnum, list;
    var newsTitle = window.sessionStorage.getItem("global_newsTitle");
    function init() {
        var getSearchList = function (data) {
            console.log(121, data);
            totalnum = data.total;
            list = data.list;
            if (list.length < 8) {
                $('.more').html('没有更多了');
            }
        };

        //参数 网站id 新闻标题 当前页 显示页
        globalQuery(1, newsTitle, page, 8, getSearchList);
        //拿到的搜索的数据
        for (var i = 0; i < list.length; i++) {
            $('#navList').append('<li> <a href=""> <div class="title"> <h3>' + list[i].newsTitle + '</h3> <span class="time">' + list[i].createDate + '</span> </div> <p class="content_news">' + list[i].subContent + '</p> </a> </li>')

        }
    }
    $('.more').click(function () {
        if (page >= Math.ceil(totalnum / 8)) {
            $('.more').html('没有更多了');
        } else {
            page++;
            init();
        }
    });
</script>