<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>网站管理</title>
    <link rel="stylesheet" href="../common/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="../common/css/index.css"/>
    <link rel="stylesheet" href="../css/list.css"/>
    <script type="text/javascript" src="../common/js/jquery.min.js"></script>
    <script type="text/javascript" src="../common/js/bootstrap.min.js"></script>

    <script type="text/javascript" src="../js/pager.js"></script>
    <!--
        <script type="text/javascript" src="../common/js/common.js"></script>
    -->

    <style>
        .modal_conment{
            padding: 20px 0;
        }
        .modal_conment label{
            line-height: 40px;
            text-align: right;
        }
    </style>
</head>
<body>

<div>
    <iframe src="../common/html/header.html" frameborder="0" width="100%" height="50"></iframe>
</div>
<div class="clearfix fl">
    <iframe src="../common/html/list.html" frameborder="0" height="924"></iframe>
</div>
<div class="fl wrapper wrapper-content system" style="margin: 80px 0 0 50px;width: 75%;">
    <input type="button" value="增加" class="addModal add_btn"/>
    <div class="list_1 row">
        <table class="col-sm-12 table table-bordered table-hover">
            <thead>
            <tr>
                <th>ID</th>
                <th>网站名</th>
                <th>地址</th>
                <th>注册时间</th>
                <th>状态</th>
                <th>模板路径</th>
                <th>操作</th>
            </tr>
            </thead>
            <tbody>

            </tbody>
        </table>
    </div>
    <!--分页-->
    <div class="fr">
        <div class="fl " style="margin: 25px;">
            当前显示<span>10</span>条
            <select>
                <option value="10">10</option>
                <option value="20">20</option>
                <option value="50">50</option>
            </select>
        </div>
        <ul class="pagination page1"></ul>
        <div class="pageJump fr">
            <span>跳转到</span>
            <input type="text"/>
            <span>页</span>
            <button type="button" class="button">确定</button>
        </div>
    </div>

</div>

<!--添加弹出框-->
<div class="modal fade add" id="myModal_add" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="top: 20%;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <!--
                                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                -->
                <h4 class="modal-title" id="myModalLabel" >新增</h4>
            </div>
            <div class="modal-body" style="overflow: hidden;">
                <div class="form-group modal_conment">
                    <label class="col-sm-2 control-label">网站名称</label>

                    <div class="col-sm-8">
                        <input class="form-control input1 siteName"/>
                    </div>
                </div>
                <div class="form-group modal_conment">
                    <label class="col-sm-2 control-label">网站地址</label>

                    <div class="col-sm-8">
                        <input class="form-control input1 route"/>
                    </div>
                </div>
                <div class="form-group modal_conment">
                    <label class="col-sm-2 control-label">模板路径</label>

                    <div class="col-sm-8">
                        <input class="form-control input1 templteRoute"/>
                    </div>
                </div>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default btn2" data-dismiss="modal">关闭</button>
                <button type="button" class="btn btn-primary btn1">确认</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>
<!--修改弹出框-->
<div class="modal fade revise" id="myModal_res" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="top: 20%;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <!--
                                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                -->
                <h4 class="modal-title" id="resmyModalLabel" >修改</h4>
            </div>
            <div class="modal-body" style="overflow: hidden;">
                <!--<div class="form-group modal_conment">
                    <label class="col-sm-2 control-label">ID</label>

                    <div class="col-sm-8">
                        <input class="form-control input1 id"/>
                    </div>
                </div>-->
                <div class="form-group modal_conment">
                    <label class="col-sm-2 control-label">网站名称</label>

                    <div class="col-sm-8">
                        <input class="form-control input1 siteName" id="siteName"/>
                    </div>
                </div>
                <div class="form-group modal_conment">
                    <label class="col-sm-2 control-label">网站地址</label>

                    <div class="col-sm-8">
                        <input class="form-control input1 route" id="route"/>
                    </div>
                </div>
                <div class="form-group modal_conment">
                    <label class="col-sm-2 control-label">模板路径</label>

                    <div class="col-sm-8">
                        <input class="form-control input1 templteRoute" id="templteRoute"/>
                    </div>
                </div>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default btn2" data-dismiss="modal">关闭</button>
                <button type="button" class="btn btn-primary btn1">确认</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>
<!--网站与栏目弹出框-->
<div class="modal fade edit" id="myModal_edit" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="top: 20%;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <!--
                                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                -->
                <h4 class="modal-title" id="editmyModalLabel" >编辑栏目(websites_channel表)</h4>
            </div>
            <div class="modal-body" style="overflow: hidden;">
                <div class="form-group modal_conment">
                    <label>栏目选择</label>:
                    <input type="checkbox" value="1" class="inputwms"/>新闻
                    <input type="checkbox" value="2"/>体育
                    <input type="checkbox" value="3"/>财经
                    <input type="checkbox" value="4"/>汽车
                    <input type="checkbox" value="5"/>房产
                    <input type="checkbox" value="6"/>趣闻
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default btn2" data-dismiss="modal">关闭</button>
                <button type="button" class="btn btn-primary btn1">确认</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>


<script type="text/javascript">
    var webData = [];
    //发送ajax请求，拿到数据并渲染到页面上
    $(document).ready(function () {
        setTimeout(function () {}, 500);


        //页面的渲染
        var Data;
        $.ajax({
            type: "get",//请求方式
            url: "websites.json",//请求路径
            async: false,
            contentType: "application/json",
            dataType: "json", //数据格式
            success: function (data) {
                Data=data;
                ergodic(data);


            }
        });

        function ergodic(Data) {
            $("tbody").empty();
            for (var i = 0; i < Data.length; i++) {
                webData.push(Data[i].id,Data[i].siteName,Data[i].route,Data[i].templteRoute,Data[i].isUse);
                str = "<tr>" +
                "<td>" + Data[i].id + "</td>" +
                "<td>" + Data[i].siteName + "</td>" +
                "<td>" + Data[i].route + "</td>" +
                "<td>" + Data[i].createDate + "</td>" +
                '<td><p class="' + (Data[i].isUse == 0 ? 'anniu' : 'anniu active') + '" onclick="anniu(this)"><span> </span></p></td>' +  //+ resultdata[i].isUse +
                "<td>" + Data[i].templteRoute + "</td>" +
                "<td align='center'>" +
                "<input type='button' value='编辑栏目' onclick='edit(this)' style='margin: 0 20px'/>" +
                "<input type='button' value='修改' onclick='revise(this)' style='margin: 0 20px'/>" +
                "</td>"+"</tr>";
                $("tbody").append(str);
            }

        }



        //新增
        $(".add_btn").click(function () {
            $(".add").show();
        })
        $(".add .btn1").click(function () {
            var siteName = $(".siteName").val();
            var route = $(".route").val();
            var templteRoute = $(".templteRoute").val();
            for (var i = 0; i < Data.length; i++) {
                if (siteName == Data[i].siteName || route == Data[i].route|| templteRoute == Data[i].templteRoute) {
                    alert('网站已存在');
                    return;
                }
            }
            Data.push({siteName: siteName, route: route,templteRoute:templteRoute});
            ergodic(Data);//Data是添加后的数据
            $(".add").hide();
        })
        $(".add .btn2").click(function () {
            $(".add").hide();
        })





        /*分页*/
        Page({
            num: 100,					//页码数
            startnum: 1,				//指定页码
            elem: $('.page1'),		//指定的元素
            callback: function (n) {	//回调函数
                //console.log(n)
                var dataPage = {};
                dataPage["pagecur"] = n;//page
                dataPage["text1_find"] = $(".text1_find").val();//查找条件的值
                dataPage["option"] = $("option").val();//当前页显示条数的值

                $.ajax({
                    type: "get",//请求方式
                    url: "http://123.59.156.27:8080/websites/add",//请求路径
                    async: false,
                    contentType: "application/json",
                    dataType: "websites.json", //数据格式
                    data: JSON.stringify(dataPage),
                    success: function (dataPage) {
                        ergodic(dataPage);
                    }
                })
            }
        });


    });



</script>
</body>
</html>